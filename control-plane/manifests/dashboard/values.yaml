kubernetes-dashboard:
  protocolHttp: false
  app:  
    ingress:
      enabled: true
      issuer: 
        name: letsencrypt-staging
        scope: cluster
      tls:
        enabled: true
      hosts:
        - dashboard.tineochristopher.com
      path: /
      pathType: Prefix
      ingressClassName: nginx
      pathType: Prefix
      annotations:
        nginx.ingress.kubernetes.io/backend-protocol: "HTTPS"

        # External DNS
        external-dns.alpha.kubernetes.io/hostname: dashboard.tineochristopher.com
        external-dns.alpha.kubernetes.io/target: 96.248.109.98

        # oauth2-proxy annotations
        nginx.ingress.kubernetes.io/ssl-redirect: "true"
        nginx.ingress.kubernetes.io/auth-url: "https://dashboard.tineochristopher.com/oauth2/auth"
        nginx.ingress.kubernetes.io/auth-signin: "https://dashboard.tineochristopher.com/oauth2/start?rd=$escaped_request_uri"
        nginx.ingress.kubernetes.io/auth-response-headers: "authorization"
        nginx.ingress.kubernetes.io/configuration-snippet: |
          if ($request_uri = "/favicon.ico") {
            return 204;
          }

oauth2-proxy:
  config:
    existingSecret: dashboard-oauth2-proxy
  extraArgs:
    provider: oidc
    upstream: "https://dashboard.tineochristopher.com"
    redirect-url: "https://dashboard.tineochristopher.com/oauth2/callback"
    oidc-issuer-url: "https://keycloak.tineochristopher.com/realms/kubernetes"
    allowed-group: cluster-admins
    scope: openid email profile
    email-domain: "*"
    cookie-domain: ".tineochristopher.com"
    cookie-secure: true
    cookie-samesite: lax
    set-authorization-header: true
    v: "4"  # Enable debug logging
    standard-logging: true
    auth-logging: true
    request-logging: true
  ingress:
    enabled: true
    className: nginx
    path: /oauth2
    pathType: Prefix
    tls:
      - hosts:
        - dashboard.tineochristopher.com
        secretName: dashboard-kubernetes-dashboard-certs
    hosts:
      - dashboard.tineochristopher.com